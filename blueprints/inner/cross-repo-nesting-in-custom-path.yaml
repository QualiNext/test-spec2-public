spec_version: 2


inputs:
  compute_service_name:
    type: agent    

  tf_input:
    type: string
    default: "default_input_2"

  helm_release:
    type: string
    default: "helm-test"
    
# outputs:
#   tf_output: 
#     value: '{{.grains.tf1.outputs.output2}}'
    

grains:
  # tf1:
  #   kind: terraform
  #   tf-version: 1.3.5
  #   spec:
  #     source:        
  #       path: terraform/complex-references
  #       store: iac-samples
  #     agent:
  #       name: '{{.inputs.compute_service_name}}'
  #       storage-size: 950
  #     workspace-directories:
  #       - source: 
  #           name: workspace_dir1
  #           store: test-spec2-public
  #           # path: helm/nginx-test/values.yaml
  #           commit: 25dbe596bb083ca9346692f3cc846cd061f30a14        
  #     inputs:
  #       - test_input1: '{{.inputs.tf_input}}'
  #       - test_input2: "input22"  
  #     outputs:
  #       - output2

#  bp1:
#    kind: blueprint
#    depends-on: tf1
#    spec:
#      source:
#        # path: https://github.com/yakirlevi/iac-samples//terraform/simple-tf-module
#        path: blueprints/helm-with-values-yakir.yaml
#        store: test-spec2-public
#        #commit: 8ac656aafcfeaf8c1614333d3d7aabfe0c388be4
#      inputs:
#        - compute_service_name: '{{ .inputs.compute_service_name }}'
#        - release: '{{.inputs.helm_release}}'

  bp-from-other-repo:
    kind: blueprint
    spec:
      source:
        # path: https://github.com/yakirlevi/iac-samples//terraform/simple-tf-module
        path: blueprints/simple-tf-yakir.yaml
        store: test-spec2-public
      inputs:
        - compute_service_name: '{{ .inputs.compute_service_name }}' 
